
<app-my-modal modalId="modalAssignJob" modalSize="modal-md" (closeRequest)="myModal.close()">
        
       
         <!-- ส่วนหัว -->
        <div
          style="
            background:#2f3337;
            color:white;
            text-align:center;
            font-weight:600;
            font-size:18px;
            padding:8px 0;
            border-top-left-radius:8px;
            border-top-right-radius:8px;
          ">
          {{modalName}} 
        </div>
  
        <!-- เนื้อหาโมดัล -->
        <div style="font-family:'Kanit',sans-serif; background:#f6fbf8; border-radius:12px; padding:16px;">
          
            <!-- Create By -->
            <div
            style="
              display:grid;
              grid-template-columns:160px 1fr;
              align-items:center;
              gap:10px;
              margin-bottom:14px;
            ">
            <label style="font-weight:700; color:#111; text-align:right;">
              Create By*
            </label>
            <input
              type="text"
              [(ngModel)]="model.createBy"
              disabled
              style="
                background:#e2e8f0;
                border:2px solid transparent;
                border-radius:10px;
                padding:.6rem .9rem;
                font-weight:600;
                width:100%;
              "
            />
          </div>


          <div
          style="
            display:grid;
            grid-template-columns:160px 1fr;
            align-items:center;
            gap:10px;
            margin-bottom:14px;
          ">
          <label style="font-weight:700; color:#111; text-align:right;">
            EmpNo*
          </label>
          <input
            type="text"
            [(ngModel)]="model.empNo"
            disabled
            style="
              background:#e2e8f0;
              border:2px solid transparent;
              border-radius:10px;
              padding:.6rem .9rem;
              font-weight:600;
              width:100%;
            "
          />
        </div>

          <!-- Group -->
          <div style="display:grid; grid-template-columns:160px 1fr; align-items:center; gap:10px; margin-bottom:14px;">
            <label style="font-weight:700; color:#111; text-align:right;">Group*</label>
            <select [(ngModel)]="model.group"  disabled
              style="background:#e2e8f0; border:2px solid transparent; border-radius:10px; padding:.6rem .9rem; font-weight:600; width:100%;">
              <option value="" disabled selected>-- Select Group --</option>
              <option *ngFor="let g of groups" [value]="g.id">
                {{g.name}}
              </option>
            </select>
          </div>
      
          <!-- Machine -->
          <div style="display:grid; grid-template-columns:160px 1fr; align-items:center; gap:10px; margin-bottom:14px;">
            <label style="font-weight:700; color:#111; text-align:right;">Machine*</label>
            <select [(ngModel)]="model.machine" (change)="onMachineChange($event)" 
            style="background:#c8f7c5; border:2px solid transparent; border-radius:10px; padding:.6rem .9rem; font-weight:600; width:100%;">
              <option value="" disabled selected>-- Select Machine --</option>
              <option *ngFor="let m of machines" [value]="m.id">
                {{ m.code }}
              </option>
            </select>
          </div>
      
          <!-- Call From -->
          <div style="display:grid; grid-template-columns:160px 1fr; align-items:center; gap:10px; margin-bottom:14px;">
            <label style="font-weight:700; color:#111; text-align:right;">Call From*</label>
            <select [(ngModel)]="model.callFrom" disabled
              style="background:#e2e8f0; border:2px solid transparent; border-radius:10px; padding:.6rem .9rem; font-weight:600; width:100%;">
              <option value="" disabled selected>-- Select Node --</option>
              <option *ngFor="let c of callNodes" [value]="c.id">
                {{ c.code }}
              </option>
            </select>
          </div>
      
          <!-- Call To -->
          <div style="display:grid; grid-template-columns:160px 1fr; align-items:center; gap:10px;">
            <label style="font-weight:700; color:#111; text-align:right;">Call To*</label>
            <select [(ngModel)]="model.callTo" (change)="onCallNodeToChange($event)"
              style="background:#c8f7c5; border:2px solid transparent; border-radius:10px; padding:.6rem .9rem; font-weight:600; width:100%;">
              <option value="" disabled selected>-- Select Node --</option>
              <option *ngFor="let f of filterByGroupFromNodecallNodes" [value]="f.id">
                {{ f.code }}
              </option>
            </select>
          </div>

          <!-- Priority (Urgent / Normal) -->
              <div
              style="
                display:grid;
                grid-template-columns:160px 1fr;
                align-items:center;
                gap:10px;
                margin-top:14px;
              "
              >
              <label style="font-weight:700; color:#111; text-align:right;">
                Priority*
              </label>

              <!-- กล่อง toggle -->
              <div style="display:flex; gap:12px;">
                
                <!-- NORMAL -->
                <div
                  (click)="togglePriority('normal')"
                  style="
                    flex:1;
                    cursor:pointer;
                    text-align:center;
                    padding:12px 0;
                    border-radius:12px;
                    font-weight:700;
                    transition:.2s;
                  "
                  [ngStyle]="{
                    background: model.priority === 'normal' ? '#c8f7c5' : '#e2e8f0',
                    border: model.priority === 'normal'
                      ? '2px solid #22c55e'
                      : '2px solid transparent',
                    color: '#111'
                  }"
                >
                  Normal
                </div>

                <!-- URGENT -->
                <div
                  (click)="togglePriority('urgent')"
                  style="
                    flex:1;
                    cursor:pointer;
                    text-align:center;
                    padding:12px 0;
                    border-radius:12px;
                    font-weight:700;
                    transition:.2s;
                  "
                  [ngStyle]="{
                    background: model.priority === 'urgent' ? '#ffe1e1' : '#e2e8f0',
                    border: model.priority === 'urgent'
                      ? '2px solid #ef4444'
                      : '2px solid transparent',
                    color: model.priority === 'urgent' ? '#b91c1c' : '#111'
                  }"
                >
                  Urgent
                </div>

              </div>
              </div>

          <!-- Remark such as description -->
          <div
          style="
            display:grid;
            grid-template-columns:160px 1fr;
            align-items:flex-start;
            gap:10px;
            margin-bottom:14px;
            margin-top:14px;
          "
          >
          <label style="font-weight:700; color:#111; text-align:right; padding-top:6px;">
            Remark
          </label>
        
          <textarea
            autoGrow
            [minHeight]="60"
            placeholder="Description / บันทึกเพิ่มเติม..."
            (input)="onRemarkChange($event)"
            style="
              background:#e2e8f0;
              border:2px solid transparent;
              border-radius:10px;
              padding:.6rem .9rem;
              font-weight:600;
              width:100%;
              overflow:hidden;   /* ไม่ให้แสดง scrollbar */
              resize:none;        /* ไม่ต้องลาก */
            "
          ></textarea>
        </div>
        
      
          <!-- Error -->
          <div *ngIf="errorMsg"
            style="margin-top:14px; background:#ffd5d5; color:#a30000; border-radius:8px; padding:8px 12px; font-weight:600;">
            {{ errorMsg }}
          </div>
      
          <!-- ปุ่มล่าง -->
          <div style="margin-top:18px; display:flex; justify-content:flex-end; gap:10px; background:#f1f5f9; padding-top:10px; border-top:1px solid #ddd;">
            <button class="btn btn-outline-secondary" (click)="clear()" [disabled]="isLoading"
              style="border:2px solid #ccc; border-radius:10px; padding:.5rem 1.2rem; font-weight:700; min-width:120px;">
              <i class="fa fa-eraser me-1"></i>Clear
            </button>
            <button class="btn btn-primary" (click)="save()" [disabled]="!canSave"
              style="background:#1678ff; border:none; border-radius:10px; padding:.5rem 1.2rem; font-weight:700; min-width:120px;">
              <i class="fa fa-check me-1"></i>{{ isLoading ? 'กำลังบันทึก…' : 'บันทึก' }}
            </button>
          </div>
        </div>
</app-my-modal>